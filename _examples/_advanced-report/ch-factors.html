<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Analyse van factoren â€“ No Fairness without Awareness - Advanced</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch-equity.html" rel="next">
<link href="./ch-models.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0626ff4d7a71b55c8707dcae1d04a9b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2d8d5bf1ebe9b9250812659bbfb1ff2b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden",
    "search-label": "Zoeken"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">No Fairness without Awareness - Advanced</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Zoeken"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Schakel navigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.dehaagsehogeschool.nl/onderzoek/centres-expertise/no-fairness-without-awareness"> <i class="bi bi-info-square" role="img" aria-label="Over het onderzoek No Fairness without Awareness">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/LTA-HHs/lta-hhs-tidymodels-studiesucces/" title="Broncode" class="quarto-navigation-tool px-1" aria-label="Broncode"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Schakel zijbalknavigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Schakel zijbalknavigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="sec-factoranalyse" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analyse van factoren</span></span></h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Samenvatting</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Analyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inleiding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Prognosemodel Retentie na 1 jaar</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-factors.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analyse van factoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-equity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse van kansengelijkheid</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referenties</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bijlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Schakel sectie">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./x-a-appendix-abbreviations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Afkortingen</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhoudsopgave</h2>
   
  <ul>
  <li><a href="#inleiding" id="toc-inleiding" class="nav-link active" data-scroll-target="#inleiding"><span class="header-section-number">3.1</span> Inleiding</a></li>
  <li><a href="#voorbereidingen" id="toc-voorbereidingen" class="nav-link" data-scroll-target="#voorbereidingen"><span class="header-section-number">3.2</span> Voorbereidingen</a>
  <ul class="collapse">
  <li><a href="#laad-de-data" id="toc-laad-de-data" class="nav-link" data-scroll-target="#laad-de-data"><span class="header-section-number">3.2.1</span> Laad de data</a></li>
  </ul></li>
  <li><a href="#verdiepende-analyse-van-het-model" id="toc-verdiepende-analyse-van-het-model" class="nav-link" data-scroll-target="#verdiepende-analyse-van-het-model"><span class="header-section-number">3.3</span> Verdiepende analyse van het model</a>
  <ul class="collapse">
  <li><a href="#maak-een-explainer" id="toc-maak-een-explainer" class="nav-link" data-scroll-target="#maak-een-explainer"><span class="header-section-number">3.3.1</span> Maak een explainer</a></li>
  <li><a href="#toets-de-root-mean-square-error-na-permutaties" id="toc-toets-de-root-mean-square-error-na-permutaties" class="nav-link" data-scroll-target="#toets-de-root-mean-square-error-na-permutaties"><span class="header-section-number">3.3.2</span> Toets de Root Mean Square Error na permutaties</a></li>
  <li><a href="#inspecteer-variabelen-met-de-meeste-invloed" id="toc-inspecteer-variabelen-met-de-meeste-invloed" class="nav-link" data-scroll-target="#inspecteer-variabelen-met-de-meeste-invloed"><span class="header-section-number">3.3.3</span> Inspecteer variabelen met de meeste invloed</a></li>
  <li><a href="#shapley" id="toc-shapley" class="nav-link" data-scroll-target="#shapley"><span class="header-section-number">3.3.4</span> Shapley</a></li>
  <li><a href="#what-if-een-ceteris-paribus-analyse" id="toc-what-if-een-ceteris-paribus-analyse" class="nav-link" data-scroll-target="#what-if-een-ceteris-paribus-analyse"><span class="header-section-number">3.3.5</span> What-if: een Ceteris Paribus analyse</a></li>
  <li><a href="#partial-dependence-analyse" id="toc-partial-dependence-analyse" class="nav-link" data-scroll-target="#partial-dependence-analyse"><span class="header-section-number">3.3.6</span> Partial Dependence analyse</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/LTA-HHs/lta-hhs-tidymodels-studiesucces/issues/new" class="toc-action"><i class="bi bi-github"></i>Een probleem melden</a></li></ul></div><div class="quarto-other-links"><h2>Meer informatie</h2><ul><li><a href="https://www.dehaagsehogeschool.nl/onderzoek/lectoraten/learning-technology-analytics"><i class="bi bi-link-45deg"></i>Over het lectoraat Learning Technology &amp; Analytics</a></li><li><a href="https://www.dehaagsehogeschool.nl/onderzoek/kenniscentra/no-fairness-without-awareness"><i class="bi bi-link-45deg"></i>Over het onderzoeksprogramma 'No Fairness without Awareness'</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="sec-factoranalyse" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analyse van factoren</span></span></h1>
<p class="subtitle lead">Een analyse van kansengelijkheid in studiesucces (Retentie na 1 jaar)</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- Title -->
<!-- HEADER -->
<!-- Studyprogram short -->
<p><strong>Communication and Multimedia Design</strong> (CMD), voltijd, eerstejaars, Faculteit IT &amp; Design (ITD).</p>
<p>&nbsp;</p>
<!-- Introduction -->
<section id="inleiding" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="inleiding"><span class="header-section-number">3.1</span> Inleiding</h2>
<p>In deze verdiepende analyse gaan we in op de <strong>factoren</strong> om beter te begrijpen hoe deze retentie verklaren.</p>
<p>Deze verdiepende factoranalyse heeft de volgende stappen:</p>
<ol type="1">
<li>We gebruiken het beste model om de prognose te verklaren en te begrijpen. We kijken naar de bijdrage van de variabelen aan de voorspelling en passen het model toe op de meest voorkomende studenten.</li>
<li>Vervolgens onderzoeken we de stabiliteit van de invloed van de verklarende variabelen met behulp van <em>Shapley</em> waarden.</li>
<li>Daarna onderzoeken we hoe de retentie er <em>anders</em> uit zou kunnen zien als de studenten andere kenmerken zouden hebben met een <em>Ceteris Paribus analyse</em>.</li>
<li>Tot slot onderzoeken we per variabele de variantie van de voorspellingen met een <em>Partial Dependence analyse</em>.<br>
</li>
</ol>
<p>Deze verdiepende factoranalyse heeft 6 stappen:</p>
<ol type="1">
<li>We lezen de bewerkte dataset in en de modellen die we in de basis-analyse hebben gemaakt.</li>
<li>We maken een <em>explainer</em> om de modellen beter te begrijpen en te kunnen uitleggen. Dit lichten we later in deze pagina toe.</li>
<li>We gebruiken het beste model om de prognose te verklaren en te begrijpen. We kijken naar de bijdrage van de variabelen aan de voorspelling en passen het model toe op de meest voorkomende studenten.</li>
<li>Vervolgens onderzoeken we de stabiliteit van de invloed van de verklarende variabelen met behulp van <em>Shapley</em> waarden.</li>
<li>Daarna onderzoeken we hoe de retentie er <em>anders</em> uit zou kunnen zien als de studenten andere kenmerken zouden hebben met een <em>Ceteris Paribus analyse</em>.</li>
<li>Tot slot onderzoeken we per variabele de variantie van de voorspellingen met een <em>Partial Dependence analyse</em>.<br>
</li>
</ol>
<!-- Data -->
</section>
<section id="voorbereidingen" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="voorbereidingen"><span class="header-section-number">3.2</span> Voorbereidingen</h2>
<section id="laad-de-data" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="laad-de-data"><span class="header-section-number">3.2.1</span> Laad de data</h3>
<p>We laden de bewerkte data en prognosemodellen in voor:</p>
<p><strong>Opleiding</strong>: | (Synth) (CMD), VT, eerstejaars - <strong>Retentie na 1 jaar</strong></p>
<!-- Include load-dfpersona -->
<div class="cell">
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a list of dfPersonas</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>lDfPersona <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Walk over the variables</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>lDfPersona <span class="ot">&lt;-</span> <span class="fu">map</span>(lSensitive_labels,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">~</span> <span class="fu">Get_dfPersona_Recursive</span>(.x)) <span class="sc">|&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(lSensitive_labels)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dfPersona_per_group <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(lDfPersona) </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Save this file as an Excel spreadsheet</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sOutputPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"R/data"</span>, <span class="st">"dfPersona_per_group.xlsx"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(dfPersona_per_group, sOutputPath)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the personas</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>dfPersona_all <span class="ot">&lt;-</span> <span class="fu">Get_dfPersona_Recursive</span>()</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="verdiepende-analyse-van-het-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="verdiepende-analyse-van-het-model"><span class="header-section-number">3.3</span> Verdiepende analyse van het model</h2>
<p>We weten van de factoren nog niet hoe en in welke richting ze retentie verklaren: dragen ze sterk bij of juist niet, verhogen of verlagen ze retentie?</p>
<section id="maak-een-explainer" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="maak-een-explainer"><span class="header-section-number">3.3.1</span> Maak een explainer</h3>
<p>We gaan nu een stap verder met behulp van het <code>DALEX</code> package. Op basis van het tidymodels model (zie hoofdstuk 3) extraheren we de informatie voor de explainer van Dalex.</p>
<!-- Include the fitted model -->
<div class="cell">
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the best model</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sBest_model <span class="ot">&lt;-</span> dfModel_results<span class="sc">$</span>model[dfModel_results<span class="sc">$</span>best <span class="sc">==</span> <span class="cn">TRUE</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>last_fit    <span class="ot">&lt;-</span> lLast_fits[[sBest_model]]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>fitted_model <span class="ot">&lt;-</span> last_fit <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># If the model is logistic regression, check that the coefficients of the model are numerical</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(sBest_model <span class="sc">==</span> <span class="st">"Logistic Regression"</span>) {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">&lt;-</span> <span class="fu">tidy</span>(fitted_model)<span class="sc">$</span>estimate</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check that the coefficients are numerical</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(coefs)) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"De geÃ«xtraheerde coÃ«fficiÃ«nten zijn niet numeriek."</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- Include the last fit explainer -->
<div class="cell">
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fitted model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fitted_model <span class="ot">&lt;-</span> last_fit <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the workflow</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> last_fit <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an explainer</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>explain_lf <span class="ot">&lt;-</span> DALEX<span class="sc">::</span><span class="fu">explain</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> workflow,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dfOpleiding_inschrijvingen <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>Retentie),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> dfOpleiding_inschrijvingen<span class="sc">$</span>Retentie,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">colorize =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> sBest_model)</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Preparation of a new explainer is initiated
  -&gt; model label       :  Random Forest 
  -&gt; data              :  1613  rows  26  cols 
  -&gt; target variable   :  1613  values 
  -&gt; predict function  :  yhat.workflow  will be used ( [33m default [39m )
  -&gt; predicted values  :  No value for predict function target column. ( [33m default [39m )
  -&gt; model_info        :  package tidymodels , ver. 1.3.0 , task classification ( [33m default [39m ) 
  -&gt; predicted values  :  numerical, min =  0.1282285 , mean =  0.6176005 , max =  0.9501541  
  -&gt; residual function :  difference between y and yhat ( [33m default [39m )
  -&gt; residuals         :  numerical, min =  -0.8617417 , mean =  0.003602241 , max =  0.8065899  
 [32m A new explainer has been created! [39m </code></pre>
</div>
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.null</span>(explain_lf<span class="sc">$</span>y_hat) <span class="sc">||</span> <span class="fu">is.null</span>(explain_lf<span class="sc">$</span>residuals)) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_danger</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The explainer does not contain the correct results. "</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Check the installation of model packages: {glue::glue_collapse(explain_lf$model_info$package, sep = ', ')}"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Solve this problem first"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="toets-de-root-mean-square-error-na-permutaties" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="toets-de-root-mean-square-error-na-permutaties"><span class="header-section-number">3.3.2</span> Toets de Root Mean Square Error na permutaties</h3>
<p>De eerste analyse is de Root Mean Square Error (RMSE) na permutaties.</p>
<ul>
<li>De <strong>RMSE</strong> is een maatstaf voor de gemiddelde afwijking van de voorspellingen van een model ten opzichte van de werkelijke waarden. Het wordt berekend als de wortel van de gemiddelde kwadratische fout.</li>
<li><strong>RMSE na permutaties</strong> wil zeggen dat de RMSE is berekend na het herhaaldelijk willekeurig herschikken (permuteren) van de waarden van een variabele in de dataset en daarmee de voorspellingen. Deze techniek passen we toe om de robuustheid en betrouwbaarheid van het model te evalueren.</li>
</ul>
<p><strong>Waarom is RMSE na permutaties nodig?</strong></p>
<ul>
<li><strong>Modelvalidatie</strong>: Door de variabelen te permuteren en de RMSE te berekenen, kunnen we de prestatie van het model vergelijken met een willekeurige schatting. Variabelen die significant beter presteren dan de gemiddelde RMSE na permutaties hebben meer voorspellende kracht.</li>
<li><strong>Overfit detectie</strong>: Als de RMSE van het originele model niet veel beter is dan de RMSE na permutaties, kan dit een indicatie zijn dat het model overfit op de trainingsdata en niet goed generaliseert naar nieuwe data.</li>
</ul>
<p>De meeste voorspellende factoren en hun RMSE zijn:</p>
<div class="cell">
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sPlotPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">Get_Plot_Outputpath</span>(<span class="at">plotname =</span> <span class="st">"lf_model_parts_rmse"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">bestmodel =</span> sBest_model))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If the plot does not exist or if recreateplots - T, create a new plot</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(sPlotPath) <span class="sc">|</span> params<span class="sc">$</span>recreateplots <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the model parts based on the RMSE; remove ID</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  mp_rmse <span class="ot">&lt;-</span> <span class="fu">model_parts</span>(explain_lf, <span class="at">loss_function =</span> loss_root_mean_square) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"ID"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a plot of the RMSE</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  mp_rmse_plot <span class="ot">&lt;-</span> <span class="fu">Get_RMSE_Plot</span>(mp_rmse)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the plot</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Finalize_Plot</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot_name =</span> mp_rmse_plot,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_filepath =</span> sPlotPath,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">height_pixels =</span> <span class="dv">50</span> <span class="sc">+</span> (<span class="dv">15</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(mp_rmse<span class="sc">$</span>variable)))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show the existing plot</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">include_graphics</span>(sPlotPath)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show the existing plot</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">include_graphics</span>(sPlotPath)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lf-model-parts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lf-model-parts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_model_parts_rmse_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figuur&nbsp;3.1: Meest voorspellende factoren - RMSE"><img src="_output/itd/b-cmd-vt-synth/plots/lf_model_parts_rmse_random_forest.png" class="img-fluid figure-img" width="1333"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lf-model-parts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.1: Meest voorspellende factoren - RMSE
</figcaption>
</figure>
</div>
</div>
</div>
<p>Het valt op dat de meest voorspellende variabelen ook een hoge RMSE hebben. Dit betekent dat deze variabelen een grote invloed hebben op de voorspelling van het model, maar per toepassing op een individuele student uit het verleden ook sterk kunnen variÃ«ren.</p>
</section>
<section id="inspecteer-variabelen-met-de-meeste-invloed" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="inspecteer-variabelen-met-de-meeste-invloed"><span class="header-section-number">3.3.3</span> Inspecteer variabelen met de meeste invloed</h3>
<p>Een volgende analyse gaat in op de variabelen met de meeste invloed. Doordat deze analyse rekening houdt met interactie effecten, niet lineaire effecten en collineariteit, kan de volgorde van variabelen wat verschillen van die van een op RMSE gebaseerde analyse.</p>
<p>Deze analyse passen we toe op de meest voorkomende student. We onderzoeken eerst de meest voorkomende student in de gehele populatie van deze opleiding. Vervolgens analyseren we de meest voorkomende student in meerdere groepen: naar geslacht, aansluiting, vooropleiding, etc. We gebruiken hiervoor bij numerieke variabelen de mediaan en van categorische variabelen de meest frequente categorie.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Ter illustratie">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ter illustratie
</div>
</div>
<div class="callout-body-container callout-body">
<p>Stel dat we een onderscheid maken tussen mannen en vrouwen, dan zullen zij verschillen in bijvoorbeeld de meest voorkomende leeftijd, het meest voorkomende studiekeuzeprofiel, etc. Zo ontstaat er per groep een unieke selectie van variabelen en waarden. De volgorde in belangrijkheid kan ook per groep verschillen.</p>
</div>
</div>
<p>We onderzoeken zo de voorspelling van het model per groep en de bijdrage van de verklarende variabelen aan die specifieke voorspelling. Dit geeft een verder inzicht in de werking van het model. Een categorie met 20 studenten of minder laten we buiten beschouwing.</p>
<section id="toelichting-op-de-opbouw-van-de-kans-op-retentie" class="level4" data-number="3.3.3.1">
<h4 data-number="3.3.3.1" class="anchored" data-anchor-id="toelichting-op-de-opbouw-van-de-kans-op-retentie"><span class="header-section-number">3.3.3.1</span> Toelichting op de opbouw van de kans op retentie</h4>
<p>De opbouw van het model bestaat uit een <em>intercept</em>, gevolgd door verklarende variabelen die een verschil maken ten opzichte van die intercept. De intercept is de <strong>basiskans op retentie</strong> voor alle studenten. Deze kans is voor de (CMD) VT <strong>61,8%</strong>. De cumulatieve bijdrage van de variabelen aan de voorspelling kan positief of negatief zijn. Een positieve bijdrage betekent dat de variabele de kans op retentie verhoogt, een negatieve bijdrage betekent dat het de kans op retentie verlaagt.</p>
<p>Het kan zijn dat nieuwe variabelen geen invloed meer hebben op de kans. Dit betekent niet per se dat ze niet belangrijk zijn. Het kan zijn dat de invloed die ze hebben op de kans al is â€˜afgevangenâ€™ door variabelen die eerder in het model zijn opgenomen.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Ter illustratie">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ter illustratie
</div>
</div>
<div class="callout-body-container callout-body">
<p>De variabele <code>Cijfer_CE_VO_missing = Ja</code> betekent dat een student geen VO cijfers heeft voor het centraal schriftelijk examen. Dit geldt voor vrijwel alle MBO studenten. Doordat de variabele <code>Cijfer_CE_VO_missing</code> de kans op retentie net wat sterker beÃ¯nvloedt, komt <code>Vooropleiding = MBO</code> niet meer voor als invloedrijke variabele, maar is dit wel de achterliggende reden dat het cijfer ontbreekt.</p>
</div>
</div>
<p>Uiteindelijk tellen alle verklarende variabelen op tot een definitieve voorspelling die per persoon verschilt, afhankelijk van hun persoonlijke verschillen per variabele.</p>
</section>
<section id="de-meest-voorkomende-student-totaal" class="level4" data-number="3.3.3.2">
<h4 data-number="3.3.3.2" class="anchored" data-anchor-id="de-meest-voorkomende-student-totaal"><span class="header-section-number">3.3.3.2</span> De meest voorkomende student (totaal)</h4>
<p>We onderzoeken eerst de meest voorkomende student in de opleiding. We analyseren de kans op retentie voor deze <em>fictieve</em> student en de bijdrage van de variabelen aan die kans. Daarbij tonen we de verdeling van de voorspellingen voor deze student voor alle variabelen en per variabele. Dit laat zien welke variabelen belangrijk zijn, naar welke kant de verdeling neigt en welke spreiding de kansverdeling heeft.</p>
<p><strong>Toelichting</strong></p>
<ul>
<li><strong>All data</strong> - De eerste variabele <code>all data</code> is eigenlijk geen variabele, maar geeft aan wat alle data samen aan kans op retentie voorspellen. Variabelen die daarna bovenaan staan, wegen het zwaarst in de voorspelling van de kans.</li>
<li><strong>Richting</strong> - Als de verdeling van de kansen naar de linkerkant van de x-as gaat, draagt deze variabele meer bij aan een toename op de kans op retentie; als deze naar de rechterkant beweegt, draagt deze variabele juist bij aan een afname op de kans op retentie</li>
<li><strong>Spreiding</strong> - Als de spreiding breed is, geeft dit aan dat er binnen deze variabele veel variatie is in de kans op retentie en er voorzichtig mee omgegaan moet worden. Als de spreiding heel smal is, betekent dit dat de variabele weinig of geen invloed heeft op de kans op retentie. Deze variabelen bevinden zich op de intercept.</li>
<li><strong>Vorm</strong> - De vorm achter de variabele (een viool) geeft de verdeling van de kans op retentie weer. Hoe breder de viool-vorm, hoe meer studenten op die locatie een kans op retentie hebben.</li>
</ul>
<div id="fig-lf-break-down-distribution-all" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lf-break-down-distribution-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_distribution_all_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figuur&nbsp;3.2: Opbouw van de kans op retentie"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_distribution_all_random_forest.png" class="img-fluid figure-img" width="1333"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lf-break-down-distribution-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.2: Opbouw van de kans op retentie
</figcaption>
</figure>
</div>
</section>
<section id="de-meest-voorkomende-student-per-groep" class="level4" data-number="3.3.3.3">
<h4 data-number="3.3.3.3" class="anchored" data-anchor-id="de-meest-voorkomende-student-per-groep"><span class="header-section-number">3.3.3.3</span> De meest voorkomende student (per groep)</h4>
<p>Nu de algemene opbouw van de kans op retentie bekend is voor de meest voorkomende student, gaan we verder met een analyse van de meest voorkomende studenten <em>per groep</em>.</p>
<p>De volgorde van de variabelen is zo gesorteerd dat per groep de meest voorspellende variabelen bovenaan staat. De volgorde verschilt per groep en geeft inzicht in wat er per groep speelt. De variabelen zijn vaak proxies voor onderliggende verschillen.</p>
<section id="naar-geslacht" class="level5" data-number="3.3.3.3.1">
<h5 data-number="3.3.3.3.1" class="anchored" data-anchor-id="naar-geslacht"><span class="header-section-number">3.3.3.3.1</span> Naar geslacht</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">M</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">V</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="fig-breakdown-geslacht-m" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-geslacht-m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_geslacht_m_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figuur&nbsp;3.3: Breakdown naar geslacht: M"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_geslacht_m_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-geslacht-m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.3: Breakdown naar geslacht: M
</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="fig-breakdown-geslacht-v" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-geslacht-v-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_geslacht_v_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figuur&nbsp;3.4: Breakdown naar geslacht: V"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_geslacht_v_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-geslacht-v-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.4: Breakdown naar geslacht: V
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="naar-aansluiting" class="level5" data-number="3.3.3.3.2">
<h5 data-number="3.3.3.3.2" class="anchored" data-anchor-id="naar-aansluiting"><span class="header-section-number">3.3.3.3.2</span> Naar aansluiting</h5>
<p>De subtotalen voor de categorieÃ«n 2e Studie en Na CD zijn te laag voor een betrouwbare analyse.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Direct</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Tussenjaar</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Switch intern</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Switch extern</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div id="fig-breakdown-aansluiting-direct" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-aansluiting-direct-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_direct_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figuur&nbsp;3.5: Breakdown naar aansluiting: Direct"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_direct_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-aansluiting-direct-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.5: Breakdown naar aansluiting: Direct
</figcaption>
</figure>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div id="fig-breakdown-aansluiting-tussenjaar" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-aansluiting-tussenjaar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_tussenjaar_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figuur&nbsp;3.6: Breakdown naar aansluiting: Tussenjaar"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_tussenjaar_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-aansluiting-tussenjaar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.6: Breakdown naar aansluiting: Tussenjaar
</figcaption>
</figure>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div id="fig-breakdown-aansluiting-switch-intern" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-aansluiting-switch-intern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_switch-intern_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figuur&nbsp;3.7: Breakdown naar aansluiting: Switch intern"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_switch-intern_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-aansluiting-switch-intern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.7: Breakdown naar aansluiting: Switch intern
</figcaption>
</figure>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div id="fig-breakdown-aansluiting-switch-extern" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-aansluiting-switch-extern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_switch-extern_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figuur&nbsp;3.8: Breakdown naar aansluiting: Switch extern"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_aansluiting_switch-extern_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-aansluiting-switch-extern-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.8: Breakdown naar aansluiting: Switch extern
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="naar-vooropleiding" class="level5" data-number="3.3.3.3.3">
<h5 data-number="3.3.3.3.3" class="anchored" data-anchor-id="naar-vooropleiding"><span class="header-section-number">3.3.3.3.3</span> Naar vooropleiding</h5>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">MBO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">HAVO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">VWO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">BD</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">CD</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">HO</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="fig-breakdown-vooropleiding-mbo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-mbo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_mbo_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figuur&nbsp;3.9: Breakdown naar vooropleiding: MBO"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_mbo_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-mbo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.9: Breakdown naar vooropleiding: MBO
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div id="fig-breakdown-vooropleiding-havo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-havo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_havo_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figuur&nbsp;3.10: Breakdown naar vooropleiding: HAVO"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_havo_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-havo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.10: Breakdown naar vooropleiding: HAVO
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div id="fig-breakdown-vooropleiding-vwo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-vwo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_vwo_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figuur&nbsp;3.11: Breakdown naar vooropleiding: VWO"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_vwo_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-vwo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.11: Breakdown naar vooropleiding: VWO
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div id="fig-breakdown-vooropleiding-bd" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-bd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_bd_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figuur&nbsp;3.12: Breakdown naar vooropleiding: BD"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_bd_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-bd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.12: Breakdown naar vooropleiding: BD
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div id="fig-breakdown-vooropleiding-cd" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_cd_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figuur&nbsp;3.13: Breakdown naar vooropleiding: CD"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_cd_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.13: Breakdown naar vooropleiding: CD
</figcaption>
</figure>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div id="fig-breakdown-vooropleiding-ho" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-breakdown-vooropleiding-ho-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_ho_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figuur&nbsp;3.14: Breakdown naar vooropleiding: HO"><img src="_output/itd/b-cmd-vt-synth/plots/lf_break_down_vooropleiding_ho_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-breakdown-vooropleiding-ho-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.14: Breakdown naar vooropleiding: HO
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="shapley" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="shapley"><span class="header-section-number">3.3.4</span> Shapley</h3>
<p>Na deze factorentanalyse kijken we naar de stabiliteit van de invloed van de verklarende variabelen. We gebruiken hiervoor <em>Shapley</em> waarden.</p>
<p>Een Shapley analyse houdt rekening met een andere volgorde van de variabelen. De volgorde van de variabelen is cumulatief (additief) en maakt dus uit voor de bijdrage aan het model: als er een andere variabele al in het model is toegevoegd, heeft dat invloed op de daaropvolgende variabele. Een Shapley analyse permuteert de volgorde van de variabelen om daarmee de verschillen te berekenen in de bijdrage aan de voorspelling. Zo krijgen we nog beter zicht op het belang en de invloed van de individuele variabelen in het prognosemodel. Variabelen zonder bijdrage hebben we verwijderd.</p>
<p>De volgorde van de variabelen in deze Shapley analyse is gelijk aan die van <a href="#fig-lf-break-down-distribution-all" class="quarto-xref">Figuur&nbsp;<span>3.2</span></a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Toon code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sPlotPath <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">Get_Plot_Outputpath</span>(<span class="at">plotname =</span> <span class="st">"lf_shapley"</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">bestmodel =</span> sBest_model))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If the plot does not exist or if recreateplots - T, create a new plot</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(sPlotPath) <span class="sc">|</span> params<span class="sc">$</span>recreateplots <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine the Shapley values</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  lf_shapley <span class="ot">&lt;-</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict_parts</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">explainer =</span> explain_lf,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">new_observation =</span> dfPersona_all[<span class="dv">1</span>, ],</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"shap"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">B =</span> <span class="dv">20</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert these to a data frame</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  dfShapley <span class="ot">&lt;-</span> <span class="fu">Get_dfShapley</span>(lf_shapley)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build the plot</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  shapley_plot <span class="ot">&lt;-</span> <span class="fu">Get_Shapley_Plot</span>(dfShapley)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the plot</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Finalize_Plot</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot_name =</span> shapley_plot,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_filepath =</span> sPlotPath,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">height_pixels =</span> <span class="dv">50</span> <span class="sc">+</span> (<span class="dv">25</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(dfShapley<span class="sc">$</span>variable_name)))</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the existing plot</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">include_graphics</span>(sPlotPath)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the existing plot</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">include_graphics</span>(sPlotPath)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Kopieer naar klembord" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-lf-shapley" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lf-shapley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_shapley_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figuur&nbsp;3.15: Shapley values"><img src="_output/itd/b-cmd-vt-synth/plots/lf_shapley_random_forest.png" class="img-fluid figure-img" width="1333"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lf-shapley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.15: Shapley values
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Toelichting:</strong></p>
<ul>
<li>De variabelen met blauwe balken <em>verhogen</em> de kans op retentie, de variabelen met rode balken <em>verlagen</em> de kans op retentie</li>
<li>De boxplot in iedere balk geeft de spreiding van de bijdrage van de variabelen aan de voorspelling weer. Hoe breder de boxplot, des te meer variatie in de bijdrage van de variabele aan de voorspelling.</li>
<li>De positie van de variabele geeft het belang van de variabele aan in de voorspelling. Hoe hoger de variabele, des te belangrijker de variabele is in de voorspelling.</li>
</ul>
<!-- Scenarios -->
</section>
<section id="what-if-een-ceteris-paribus-analyse" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="what-if-een-ceteris-paribus-analyse"><span class="header-section-number">3.3.5</span> What-if: een Ceteris Paribus analyse</h3>
<p>Vervolgens analyseren we een aantal scenarioâ€™s (wat alsâ€¦). We nemen opnieuw de meest voorkomende studenten, maar beelden nu af hoe de kans op retentie eruit zou zien als telkens een van de variabelen net wat anders was geweest.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Let op!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dit is de invloed van de variabelen bij de unieke combinatie van deze meest voorkomende student per categorie. Zie voor de invloed van een variabelen ongeacht deze unieke combinatie de analyse van Partial Dependence Profielen in de volgende paragraaf.</p>
</div>
</div>
<p>Hiervoor houden we steeds alle variabelen gelijk, op Ã©Ã©n na (<em>ceteris paribus</em> is Latijn voor â€˜al het overige gelijkâ€™). Van die ene variabelen passen we de waarden aan en zien dan het effect op de voorspelde kans op retentie. Dit geeft beter inzicht in het effect van de individuele variabelen in het model. We voeren deze analyse uit voor numerieke variabelen.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Ter illustratie">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ter illustratie
</div>
</div>
<div class="callout-body-container callout-body">
<p>Stel dat de student in dit model net een wat hoger eindexamencijfer zou hebben gehad op de middelbare school, wat zou dan de kans op retentie zijn geweest? Het is waarschijnlijk dat de kans op retentie dan hoger zou zijn geweest. Bij hbo-opleidingen die goed aansluiten hebben met een opleiding aan een universiteit, zou de kans op retentie juist lager zijn geweest omdat studenten dan na een hbo-diploma vaak doorstromen naar een universiteit.</p>
</div>
</div>
<p>Opnieuw kijken we naar geslacht, aansluiting en vooropleiding. N.B. Het kan zijn dat een van de categorieÃ«n niet zichtbaar is, dit komt doordat deze dan over elkaar heen vallen.</p>
<div id="fig-cp-geslacht" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cp-geslacht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_cp_geslacht_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figuur&nbsp;3.16: Ceteris-paribus profiel naar geslacht"><img src="_output/itd/b-cmd-vt-synth/plots/lf_cp_geslacht_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cp-geslacht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.16: Ceteris-paribus profiel naar geslacht
</figcaption>
</figure>
</div>
<div id="fig-cp-aansluiting" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cp-aansluiting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_cp_aansluiting_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figuur&nbsp;3.17: Ceteris-paribus profiel naar aansluiting"><img src="_output/itd/b-cmd-vt-synth/plots/lf_cp_aansluiting_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cp-aansluiting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.17: Ceteris-paribus profiel naar aansluiting
</figcaption>
</figure>
</div>
<div id="fig-cp-vooropleiding" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cp-vooropleiding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_cp_vooropleiding_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figuur&nbsp;3.18: Ceteris-paribus profiel naar vooropleiding"><img src="_output/itd/b-cmd-vt-synth/plots/lf_cp_vooropleiding_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cp-vooropleiding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.18: Ceteris-paribus profiel naar vooropleiding
</figcaption>
</figure>
</div>
<!-- Partial Dependence -->
</section>
<section id="partial-dependence-analyse" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="partial-dependence-analyse"><span class="header-section-number">3.3.6</span> Partial Dependence analyse</h3>
<p>Tot slot analyseren we <em>Partial Dependence</em>. Hierbij onderzoeken we de invloed van individuele variabelen op de kans op retentie, ongeacht de combinatie van de meest voorkomende studenten. Per (numerieke) variabele analyseren we de variantie binnen de kansen op retentie. We gebruiken hiervoor het gemiddelde van alle Ceteris Paribus profielen. Vandaar dat we ook wel spreken over Partial Dependence profielen (PDPâ€™s).</p>
<p>We analyseren eerst de variabelen voor alle studenten. We tonen niet alleen de gemiddelde lijn, maar ook de lijnen van individuele CP-profielen. Vervolgens analyseren op dezelfde manier de variabelen per groep: geslacht, aansluiting en vooropleiding.</p>
<p><strong>Toelichting</strong></p>
<ul>
<li>De <em>gemiddelde lijn</em> geeft de gemiddelde kans op retentie weer voor alle studenten in de dataset voor alle waarden per variabele.</li>
<li>De <em>individuele lijnen</em> geven de kans op retentie weer voor individuele studenten in de dataset voor alle waarden per variabele. De bandbreedte van de individuele lijnen geeft de spreiding van de kans op retentie weer binnen de variabele. Het toont dat de kans op retentie per student kan verschillen, zelfs als de variabele gelijk is; de richting van het verband is wel gelijk.</li>
<li>Standaard worden 100 willekeurige profielen gekozen om deze afbeeldingen op te bouwen; door deze selectie kan het zijn dat sommige categorieÃ«n met weinig observaties in de populatie niet afgebeeld worden.</li>
<li>Doordat lijnen kunnen overlappen kan het zijn dat sommige lijnen niet zichtbaar zijn. De legenda geeft aan welke mogelijke categorieÃ«n voorkomen in de analyse.</li>
</ul>
<section id="alle-studenten" class="level4" data-number="3.3.6.1">
<h4 data-number="3.3.6.1" class="anchored" data-anchor-id="alle-studenten"><span class="header-section-number">3.3.6.1</span> Alle studenten</h4>
<div id="fig-pdp-alle-studenten" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdp-alle-studenten-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_pdp_alle studenten_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figuur&nbsp;3.19: Partial Dependence profiel naar alle studenten"><img src="_output/itd/b-cmd-vt-synth/plots/lf_pdp_alle studenten_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdp-alle-studenten-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.19: Partial Dependence profiel naar alle studenten
</figcaption>
</figure>
</div>
</section>
<section id="geslacht" class="level4" data-number="3.3.6.2">
<h4 data-number="3.3.6.2" class="anchored" data-anchor-id="geslacht"><span class="header-section-number">3.3.6.2</span> Geslacht</h4>
<div id="fig-pdp-geslacht" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdp-geslacht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_pdp_geslacht_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figuur&nbsp;3.20: Partial Dependence profiel naar geslacht"><img src="_output/itd/b-cmd-vt-synth/plots/lf_pdp_geslacht_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdp-geslacht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.20: Partial Dependence profiel naar geslacht
</figcaption>
</figure>
</div>
</section>
<section id="aansluiting" class="level4" data-number="3.3.6.3">
<h4 data-number="3.3.6.3" class="anchored" data-anchor-id="aansluiting"><span class="header-section-number">3.3.6.3</span> Aansluiting</h4>
<div id="fig-pdp-aansluiting" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdp-aansluiting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_pdp_aansluiting_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figuur&nbsp;3.21: Partial Dependence profiel naar aansluiting"><img src="_output/itd/b-cmd-vt-synth/plots/lf_pdp_aansluiting_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdp-aansluiting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.21: Partial Dependence profiel naar aansluiting
</figcaption>
</figure>
</div>
</section>
<section id="vooropleiding" class="level4" data-number="3.3.6.4">
<h4 data-number="3.3.6.4" class="anchored" data-anchor-id="vooropleiding"><span class="header-section-number">3.3.6.4</span> Vooropleiding</h4>
<div id="fig-pdp-vooropleiding" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pdp-vooropleiding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="_output/itd/b-cmd-vt-synth/plots/lf_pdp_vooropleiding_random_forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figuur&nbsp;3.22: Partial Dependence profiel naar vooropleiding"><img src="_output/itd/b-cmd-vt-synth/plots/lf_pdp_vooropleiding_random_forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pdp-vooropleiding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figuur&nbsp;3.22: Partial Dependence profiel naar vooropleiding
</figcaption>
</figure>
</div>
<!-- FOOTER -->
<!-- Justification -->
<p>&nbsp;</p>
<p><strong>Verantwoording</strong></p>
<p>Deze analyse maakt deel uit van het onderzoek naar kansengelijkheid van het lectoraat Learning Technology &amp; Analytics van De Haagse Hogeschool: <a href="https://www.dehaagsehogeschool.nl/onderzoek/kenniscentra/no-fairness-without-awareness">No Fairness without Awareness</a> | Het rapport is door het lectoraat ontwikkeld in <a href="https://quarto.org/">Quarto</a> 1.6.39.</p>
<!-- Copyright -->
<p><strong>Creative Commons Licentie</strong></p>
<p>De licentie voor dit template is de <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution Share Alike 4.0 Internationaal</a>.</p>
<!-- Cleaning up -->


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch-models.html" class="pagination-link" aria-label="Prognosemodel {{< meta params.model >}}">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Prognosemodel Retentie na 1 jaar</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch-equity.html" class="pagination-link" aria-label="Analyse van kansengelijkheid">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Analyse van kansengelijkheid</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/LTA-HHs/lta-hhs-tidymodels-studiesucces/issues/new" class="toc-action"><i class="bi bi-github"></i>Een probleem melden</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>